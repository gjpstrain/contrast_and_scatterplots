mutate(decay = str_replace_all(decay, pattern = "_", replacement = " ")) %>%
mutate(decay = str_to_title(decay)) %>%
ggplot(aes(x = my_residuals, y = transformed_residual)) +
geom_line(aes(colour = decay)) +
scale_x_continuous(breaks = scales::pretty_breaks(n = 20), limits = c(0,2.6)) +
labs(x = "Residual",
y = "Contrast Alpha",
title = "Relationship between residual and contrast alpha value") +
theme_minimal() +
theme(legend.title = element_blank()) +
annotate(geom = "text", x  = 1.3, y = 0.12, label = "Non-Linear Decay", angle = -20) +
annotate(geom = "text", x  = 1.3, y = 0.4, label = "Linear Decay", angle = -38) +
annotate(geom = "text", x  = 2, y = 0.12, label = "Non-Linear Inverted Decay", angle = -23)
slopes %>%
mutate(decay = str_replace_all(decay, pattern = "_", replacement = " ")) %>%
mutate(decay = str_to_title(decay)) %>%
ggplot(aes(x = my_residuals, y = transformed_residual)) +
geom_line(aes(colour = decay)) +
scale_x_continuous(breaks = scales::pretty_breaks(n = 20), limits = c(0,2.6)) +
labs(x = "Residual",
y = "Contrast Alpha",
title = "Relationship between residual and contrast alpha value") +
theme_minimal() +
theme(legend.title = element_blank()) +
annotate(geom = "text", x  = 1.3, y = 0.12, label = "Non-Linear Decay", angle = -20) +
annotate(geom = "text", x  = 1.3, y = 0.45, label = "Linear Decay", angle = -38) +
annotate(geom = "text", x  = 2, y = 0.12, label = "Non-Linear Inverted Decay", angle = -23)
slopes %>%
mutate(decay = str_replace_all(decay, pattern = "_", replacement = " ")) %>%
mutate(decay = str_to_title(decay)) %>%
ggplot(aes(x = my_residuals, y = transformed_residual)) +
geom_line(aes(colour = decay)) +
scale_x_continuous(breaks = scales::pretty_breaks(n = 20), limits = c(0,2.6)) +
labs(x = "Residual",
y = "Contrast Alpha",
title = "Relationship between residual and contrast alpha value") +
theme_minimal() +
theme(legend.title = element_blank()) +
annotate(geom = "text", x  = 1.3, y = 0.12, label = "Non-Linear Decay", angle = -20) +
annotate(geom = "text", x  = 1.3, y = 0.45, label = "Linear Decay", angle = -40) +
annotate(geom = "text", x  = 2, y = 0.12, label = "Non-Linear Inverted Decay", angle = -23)
slopes %>%
mutate(decay = str_replace_all(decay, pattern = "_", replacement = " ")) %>%
mutate(decay = str_to_title(decay)) %>%
ggplot(aes(x = my_residuals, y = transformed_residual)) +
geom_line(aes(colour = decay)) +
scale_x_continuous(breaks = scales::pretty_breaks(n = 20), limits = c(0,2.6)) +
labs(x = "Residual",
y = "Contrast Alpha",
title = "Relationship between residual and contrast alpha value") +
theme_minimal() +
theme(legend.title = element_blank()) +
annotate(geom = "text", x  = 1.3, y = 0.12, label = "Non-Linear Decay", angle = -20) +
annotate(geom = "text", x  = 1.3, y = 0.45, label = "Linear Decay", angle = -40) +
annotate(geom = "text", x  = 2, y = 0.8, label = "Non-Linear Inverted Decay", angle = -23)
slopes %>%
mutate(decay = str_replace_all(decay, pattern = "_", replacement = " ")) %>%
mutate(decay = str_to_title(decay)) %>%
ggplot(aes(x = my_residuals, y = transformed_residual)) +
geom_line(aes(colour = decay)) +
scale_x_continuous(breaks = scales::pretty_breaks(n = 20), limits = c(0,2.6)) +
labs(x = "Residual",
y = "Contrast Alpha",
title = "Relationship between residual and contrast alpha value") +
theme_minimal() +
theme(legend.title = element_blank()) +
annotate(geom = "text", x  = 1.3, y = 0.12, label = "Non-Linear Decay", angle = -20) +
annotate(geom = "text", x  = 1.3, y = 0.45, label = "Linear Decay", angle = -40) +
annotate(geom = "text", x  = 2, y = 0.8, label = "Non-Linear Inverted Decay", angle = 23)
slopes %>%
mutate(decay = str_replace_all(decay, pattern = "_", replacement = " ")) %>%
mutate(decay = str_to_title(decay)) %>%
ggplot(aes(x = my_residuals, y = transformed_residual)) +
geom_line(aes(colour = decay)) +
scale_x_continuous(breaks = scales::pretty_breaks(n = 20), limits = c(0,2.6)) +
labs(x = "Residual",
y = "Contrast Alpha",
title = "Relationship between residual and contrast alpha value") +
theme_minimal() +
theme(legend.title = element_blank()) +
annotate(geom = "text", x  = 1.3, y = 0.12, label = "Non-Linear Decay", angle = -20) +
annotate(geom = "text", x  = 1.3, y = 0.45, label = "Linear Decay", angle = -40) +
annotate(geom = "text", x  = 2, y = 0.8, label = "Non-Linear Inverted Decay", angle = 20)
slopes %>%
mutate(decay = str_replace_all(decay, pattern = "_", replacement = " ")) %>%
mutate(decay = str_to_title(decay)) %>%
ggplot(aes(x = my_residuals, y = transformed_residual)) +
geom_line(aes(colour = decay)) +
scale_x_continuous(breaks = scales::pretty_breaks(n = 20), limits = c(0,2.6)) +
labs(x = "Residual",
y = "Contrast Alpha",
title = "Relationship between residual and contrast alpha value") +
theme_minimal() +
theme(legend.title = element_blank()) +
annotate(geom = "text", x  = 1.3, y = 0.12, label = "Non-Linear Decay", angle = -20) +
annotate(geom = "text", x  = 1.3, y = 0.45, label = "Linear Decay", angle = -40) +
annotate(geom = "text", x  = 2, y = 0.8, label = "Non-Linear Inverted Decay", angle = 15)
slopes %>%
mutate(decay = str_replace_all(decay, pattern = "_", replacement = " ")) %>%
mutate(decay = str_to_title(decay)) %>%
ggplot(aes(x = my_residuals, y = transformed_residual)) +
geom_line(aes(colour = decay)) +
scale_x_continuous(breaks = scales::pretty_breaks(n = 20), limits = c(0,2.6)) +
labs(x = "Residual",
y = "Contrast Alpha",
title = "Relationship between residual and contrast alpha value") +
theme_minimal() +
theme(legend.title = element_blank()) +
annotate(geom = "text", x  = 1.3, y = 0.12, label = "Non-Linear Decay", angle = -20) +
annotate(geom = "text", x  = 1.3, y = 0.45, label = "Linear Decay", angle = -40) +
annotate(geom = "text", x  = 2, y = 0.85, label = "Non-Linear Inverted Decay", angle = 15)
slopes %>%
mutate(decay = str_replace_all(decay, pattern = "_", replacement = " ")) %>%
mutate(decay = str_to_title(decay)) %>%
ggplot(aes(x = my_residuals, y = transformed_residual)) +
geom_line(aes(colour = decay)) +
scale_x_continuous(breaks = scales::pretty_breaks(n = 20), limits = c(0,2.6)) +
labs(x = "Residual",
y = "Contrast Alpha",
title = "Relationship between residual and contrast alpha value") +
theme_minimal() +
theme(legend.title = element_blank()) +
annotate(geom = "text", x  = 1.3, y = 0.12, label = "Non-Linear Decay", angle = -20) +
annotate(geom = "text", x  = 1.3, y = 0.45, label = "Linear Decay", angle = -40) +
annotate(geom = "text", x  = 2, y = 0.88, label = "Non-Linear Inverted Decay", angle = 15)
slopes %>%
mutate(decay = str_replace_all(decay, pattern = "_", replacement = " ")) %>%
mutate(decay = str_to_title(decay)) %>%
ggplot(aes(x = my_residuals, y = transformed_residual)) +
geom_line(aes(colour = decay)) +
scale_x_continuous(breaks = scales::pretty_breaks(n = 20), limits = c(0,2.6)) +
labs(x = "Residual",
y = "Contrast Alpha",
title = "Relationship between residual and contrast alpha value") +
theme_minimal() +
theme(legend.title = element_blank(),
legend.position = "none") +
annotate(geom = "text", x  = 1.3, y = 0.12, label = "Non-Linear Decay", angle = -20) +
annotate(geom = "text", x  = 1.3, y = 0.3, label = "Linear Decay", angle = -45) +
annotate(geom = "text", x  = 2, y = 0.12, label = "Non-Linear Inverted Decay", angle = -23)
library(MASS)
set.seed(1234)
my_desired_r = 0.2
my_sample_size = 128
mean_variable_1 = 0
sd_variable_1 = 1
mean_variable_2 = 0
sd_variable_2 = 1
mu <- c(mean_variable_1, mean_variable_2)
myr <- my_desired_r * sqrt(sd_variable_1) * sqrt(sd_variable_2)
mysigma <- matrix(c(sd_variable_1, myr, myr, sd_variable_2), 2, 2)
corr_data = as_tibble(mvrnorm(my_sample_size, mu, mysigma, empirical = TRUE))
corr_model <- lm(V2 ~ V1, data = corr_data)
my_residuals <- abs(residuals(corr_model))
data_with_resid <- round(cbind(corr_data, my_residuals), 2)
slopes <- data_with_resid %>%
mutate(decay_linear = ((-my_residuals/2.6) + 1)) %>%
mutate(decay_inverted = 1-(0.25)^my_residuals) %>%
mutate(decay_non_linear = (1 + (0.25)^ my_residuals)-1) %>%
pivot_longer(cols = starts_with("de"),
names_to = c("decay"),
values_to = "transformed_residual")
slopes %>%
mutate(decay = str_replace_all(decay, pattern = "_", replacement = " ")) %>%
mutate(decay = str_to_title(decay)) %>%
ggplot(aes(x = my_residuals, y = transformed_residual)) +
geom_line(aes(colour = decay)) +
scale_x_continuous(breaks = scales::pretty_breaks(n = 20), limits = c(0,2.6)) +
labs(x = "Residual",
y = "Contrast Alpha",
title = "Relationship between residual and contrast alpha value") +
theme_minimal() +
theme(legend.title = element_blank(),
legend.position = "none") +
annotate(geom = "text", x  = 1.3, y = 0.12, label = "Non-Linear Decay", angle = -20) +
annotate(geom = "text", x  = 1.3, y = 0.3, label = "Linear Decay", angle = -45) +
annotate(geom = "text", x  = 2, y = 0.12, label = "Non-Linear Inverted Decay", angle = -23)
coord_cartesian(xlim = c(0,2.6), ylim = c(0,1))
setwd("C:/Users/mbch4gs2/local_work/contrast_and_scatterplots")
knitr::opts_chunk$set(echo = TRUE)
# Knitting this document requires tinytex (install.packages("tinytex"))
# For formatting to be correct, additional tinytex packages are required
# Run tinytex:::install_yihui_pkgs() before knitting
library(MASS)
set.seed(1234)
my_desired_r = 0.2
my_sample_size = 128
mean_variable_1 = 0
sd_variable_1 = 1
mean_variable_2 = 0
sd_variable_2 = 1
mu <- c(mean_variable_1, mean_variable_2)
myr <- my_desired_r * sqrt(sd_variable_1) * sqrt(sd_variable_2)
mysigma <- matrix(c(sd_variable_1, myr, myr, sd_variable_2), 2, 2)
corr_data = as_tibble(mvrnorm(my_sample_size, mu, mysigma, empirical = TRUE))
library(rticles)
library(tidyverse)
library(MASS)
library(emmeans)
library(scales)
library(buildmer)
library(lme4)
library(kableExtra)
library(afex)
library(papaja)
library(broom.mixed)
library(insight)
library(qwraps2)
library(lmerTest)
library(tinylabels)
library(MASS)
set.seed(1234)
my_desired_r = 0.2
my_sample_size = 128
mean_variable_1 = 0
sd_variable_1 = 1
mean_variable_2 = 0
sd_variable_2 = 1
mu <- c(mean_variable_1, mean_variable_2)
myr <- my_desired_r * sqrt(sd_variable_1) * sqrt(sd_variable_2)
mysigma <- matrix(c(sd_variable_1, myr, myr, sd_variable_2), 2, 2)
corr_data = as_tibble(mvrnorm(my_sample_size, mu, mysigma, empirical = TRUE))
corr_model <- lm(V2 ~ V1, data = corr_data)
my_residuals <- abs(residuals(corr_model))
data_with_resid <- round(cbind(corr_data, my_residuals), 2)
slopes <- data_with_resid %>%
mutate(decay_linear = ((-my_residuals/2.6) + 1)) %>%
mutate(decay_inverted = 1-(0.25)^my_residuals) %>%
mutate(decay_non_linear = (1 + (0.25)^ my_residuals)-1) %>%
pivot_longer(cols = starts_with("de"),
names_to = c("decay"),
values_to = "transformed_residual")
slopes %>%
mutate(decay = str_replace_all(decay, pattern = "_", replacement = " ")) %>%
mutate(decay = str_to_title(decay)) %>%
ggplot(aes(x = my_residuals, y = transformed_residual)) +
geom_line(aes(colour = decay)) +
scale_x_continuous(breaks = scales::pretty_breaks(n = 20), limits = c(0,2.6)) +
labs(x = "Residual",
y = "Contrast Alpha",
title = "Relationship between residual and contrast alpha value") +
theme_minimal() +
theme(legend.title = element_blank(),
legend.position = "none") +
annotate(geom = "text", x  = 1.3, y = 0.12, label = "Non-Linear Decay", angle = -20) +
annotate(geom = "text", x  = 1.3, y = 0.42, label = "Linear Decay", angle = -30) +
annotate(geom = "text", x  = 2, y = 0.12, label = "Non-Linear Inverted Decay", angle = -23)
coord_cartesian(xlim = c(0,2.6), ylim = c(0,1))
library(MASS)
set.seed(1234)
my_desired_r = 0.2
my_sample_size = 128
mean_variable_1 = 0
sd_variable_1 = 1
mean_variable_2 = 0
sd_variable_2 = 1
mu <- c(mean_variable_1, mean_variable_2)
myr <- my_desired_r * sqrt(sd_variable_1) * sqrt(sd_variable_2)
mysigma <- matrix(c(sd_variable_1, myr, myr, sd_variable_2), 2, 2)
corr_data = as_tibble(mvrnorm(my_sample_size, mu, mysigma, empirical = TRUE))
corr_model <- lm(V2 ~ V1, data = corr_data)
my_residuals <- abs(residuals(corr_model))
data_with_resid <- round(cbind(corr_data, my_residuals), 2)
slopes <- data_with_resid %>%
mutate(decay_linear = ((-my_residuals/2.6) + 1)) %>%
mutate(decay_inverted = 1-(0.25)^my_residuals) %>%
mutate(decay_non_linear = (1 + (0.25)^ my_residuals)-1) %>%
pivot_longer(cols = starts_with("de"),
names_to = c("decay"),
values_to = "transformed_residual")
slopes %>%
mutate(decay = str_replace_all(decay, pattern = "_", replacement = " ")) %>%
mutate(decay = str_to_title(decay)) %>%
ggplot(aes(x = my_residuals, y = transformed_residual)) +
geom_line(aes(colour = decay)) +
scale_x_continuous(breaks = scales::pretty_breaks(n = 20), limits = c(0,2.6)) +
labs(x = "Residual",
y = "Contrast Alpha",
title = "Relationship between residual and contrast alpha value") +
theme_minimal() +
theme(legend.title = element_blank(),
legend.position = "none") +
annotate(geom = "text", x  = 1.3, y = 0.12, label = "Non-Linear Decay", angle = -20) +
annotate(geom = "text", x  = 1.3, y = 0.44, label = "Linear Decay", angle = -30) +
annotate(geom = "text", x  = 2, y = 0.12, label = "Non-Linear Inverted Decay", angle = -23)
coord_cartesian(xlim = c(0,2.6), ylim = c(0,1))
slopes %>%
mutate(decay = str_replace_all(decay, pattern = "_", replacement = " ")) %>%
mutate(decay = str_to_title(decay)) %>%
ggplot(aes(x = my_residuals, y = transformed_residual)) +
geom_line(aes(colour = decay)) +
scale_x_continuous(breaks = scales::pretty_breaks(n = 20), limits = c(0,2.6)) +
labs(x = "Residual",
y = "Contrast Alpha",
title = "Relationship between residual and contrast alpha value") +
theme_minimal() +
theme(legend.title = element_blank(),
legend.position = "none") +
annotate(geom = "text", x  = 1.3, y = 0.12, label = "Non-Linear Decay", angle = -20) +
annotate(geom = "text", x  = 1.3, y = 0.44, label = "Linear Decay", angle = -30) +
annotate(geom = "text", x  = 2, y = 0.75, label = "Non-Linear Inverted Decay", angle = 20)
slopes %>%
mutate(decay = str_replace_all(decay, pattern = "_", replacement = " ")) %>%
mutate(decay = str_to_title(decay)) %>%
ggplot(aes(x = my_residuals, y = transformed_residual)) +
geom_line(aes(colour = decay)) +
scale_x_continuous(breaks = scales::pretty_breaks(n = 20), limits = c(0,2.6)) +
labs(x = "Residual",
y = "Contrast Alpha",
title = "Relationship between residual and contrast alpha value") +
theme_minimal() +
theme(legend.title = element_blank(),
legend.position = "none") +
annotate(geom = "text", x  = 1.3, y = 0.12, label = "Non-Linear Decay", angle = -20) +
annotate(geom = "text", x  = 1.3, y = 0.44, label = "Linear Decay", angle = -30) +
annotate(geom = "text", x  = 2, y = 0.85, label = "Non-Linear Inverted Decay", angle = 20)
slopes %>%
mutate(decay = str_replace_all(decay, pattern = "_", replacement = " ")) %>%
mutate(decay = str_to_title(decay)) %>%
ggplot(aes(x = my_residuals, y = transformed_residual)) +
geom_line(aes(colour = decay)) +
scale_x_continuous(breaks = scales::pretty_breaks(n = 20), limits = c(0,2.6)) +
labs(x = "Residual",
y = "Contrast Alpha",
title = "Relationship between residual and contrast alpha value") +
theme_minimal() +
theme(legend.title = element_blank(),
legend.position = "none") +
annotate(geom = "text", x  = 1.3, y = 0.12, label = "Non-Linear Decay", angle = -20) +
annotate(geom = "text", x  = 1.3, y = 0.44, label = "Linear Decay", angle = -30) +
annotate(geom = "text", x  = 2, y = 0.85, label = "Non-Linear Inverted Decay", angle = 15)
slopes %>%
mutate(decay = str_replace_all(decay, pattern = "_", replacement = " ")) %>%
mutate(decay = str_to_title(decay)) %>%
ggplot(aes(x = my_residuals, y = transformed_residual)) +
geom_line(aes(colour = decay)) +
scale_x_continuous(breaks = scales::pretty_breaks(n = 20), limits = c(0,2.6)) +
labs(x = "Residual",
y = "Contrast Alpha",
title = "Relationship between residual and contrast alpha value") +
theme_minimal() +
theme(legend.title = element_blank(),
legend.position = "none") +
annotate(geom = "text", x  = 1.3, y = 0.12, label = "Non-Linear Decay", angle = -20) +
annotate(geom = "text", x  = 1.3, y = 0.44, label = "Linear Decay", angle = -30) +
annotate(geom = "text", x  = 2, y = 0.85, label = "Non-Linear Inverted Decay", angle = 10)
slopes %>%
mutate(decay = str_replace_all(decay, pattern = "_", replacement = " ")) %>%
mutate(decay = str_to_title(decay)) %>%
ggplot(aes(x = my_residuals, y = transformed_residual)) +
geom_line(aes(colour = decay)) +
scale_x_continuous(breaks = scales::pretty_breaks(n = 20), limits = c(0,2.6)) +
labs(x = "Residual",
y = "Contrast Alpha",
title = "Relationship between residual and contrast alpha value") +
theme_minimal() +
theme(legend.title = element_blank(),
legend.position = "none") +
annotate(geom = "text", x  = 1.3, y = 0.12, label = "Non-Linear Decay", angle = -20) +
annotate(geom = "text", x  = 1.3, y = 0.44, label = "Linear Decay", angle = -30) +
annotate(geom = "text", x  = 2, y = 0.88, label = "Non-Linear Inverted Decay", angle = 10)
slopes %>%
mutate(decay = str_replace_all(decay, pattern = "_", replacement = " ")) %>%
mutate(decay = str_to_title(decay)) %>%
ggplot(aes(x = my_residuals, y = transformed_residual)) +
geom_line(aes(colour = decay)) +
scale_x_continuous(breaks = scales::pretty_breaks(n = 20), limits = c(0,2.6)) +
labs(x = "Residual",
y = "Contrast Alpha",
title = "Relationship between residual and contrast alpha value") +
theme_minimal() +
theme(legend.title = element_blank(),
legend.position = "none") +
annotate(geom = "text", x  = 1.3, y = 0.12, label = "Non-Linear Decay", angle = -20) +
annotate(geom = "text", x  = 1.3, y = 0.44, label = "Linear Decay", angle = -30) +
annotate(geom = "text", x  = 2, y = 0.88, label = "Non-Linear Inverted Decay", angle = 8)
knitr::opts_chunk$set(echo = TRUE)
# Knitting this document requires tinytex (install.packages("tinytex"))
# For formatting to be correct, additional tinytex packages are required
# Run tinytex:::install_yihui_pkgs() before knitting
set.seed(1234) # seed for all random number generation
# Loading packages
library(rticles)
library(tidyverse)
library(MASS)
library(emmeans)
library(scales)
library(buildmer)
library(lme4)
library(kableExtra)
library(afex)
library(papaja)
library(broom.mixed)
library(insight)
library(qwraps2)
library(lmerTest)
library(tinylabels)
tinytex:::install_yihui_pkgs()
library(MASS)
set.seed(1234)
my_desired_r = 0.2
my_sample_size = 128
mean_variable_1 = 0
sd_variable_1 = 1
mean_variable_2 = 0
sd_variable_2 = 1
mu <- c(mean_variable_1, mean_variable_2)
myr <- my_desired_r * sqrt(sd_variable_1) * sqrt(sd_variable_2)
mysigma <- matrix(c(sd_variable_1, myr, myr, sd_variable_2), 2, 2)
corr_data = as_tibble(mvrnorm(my_sample_size, mu, mysigma, empirical = TRUE))
corr_model <- lm(V2 ~ V1, data = corr_data)
my_residuals <- abs(residuals(corr_model))
data_with_resid <- round(cbind(corr_data, my_residuals), 2)
slopes <- data_with_resid %>%
mutate(decay_linear = ((-my_residuals/2.6) + 1)) %>%
mutate(decay_inverted = 1-(0.25)^my_residuals) %>%
mutate(decay_non_linear = (1 + (0.25)^ my_residuals)-1) %>%
pivot_longer(cols = starts_with("de"),
names_to = c("decay"),
values_to = "transformed_residual")
slopes %>%
mutate(decay = str_replace_all(decay, pattern = "_", replacement = " ")) %>%
mutate(decay = str_to_title(decay)) %>%
ggplot(aes(x = my_residuals, y = transformed_residual)) +
geom_line(aes(colour = decay)) +
scale_x_continuous(breaks = scales::pretty_breaks(n = 20), limits = c(0,2.6)) +
labs(x = "Residual",
y = "Contrast Alpha",
title = "Relationship between residual and contrast alpha value") +
theme_minimal() +
theme(legend.title = element_blank(),
legend.position = "none") +
annotate(geom = "text", x  = 1.3, y = 0.12, label = "Non-Linear Decay", angle = -20) +
annotate(geom = "text", x  = 1.3, y = 0.44, label = "Linear Decay", angle = -30) +
annotate(geom = "text", x  = 2, y = 0.88, label = "Non-Linear Inverted Decay", angle = 8)
coord_cartesian(xlim = c(0,2.6), ylim = c(0,1))
library(MASS)
set.seed(1234)
my_desired_r = 0.2
my_sample_size = 128
mean_variable_1 = 0
sd_variable_1 = 1
mean_variable_2 = 0
sd_variable_2 = 1
mu <- c(mean_variable_1, mean_variable_2)
myr <- my_desired_r * sqrt(sd_variable_1) * sqrt(sd_variable_2)
mysigma <- matrix(c(sd_variable_1, myr, myr, sd_variable_2), 2, 2)
corr_data = as_tibble(mvrnorm(my_sample_size, mu, mysigma, empirical = TRUE))
corr_model <- lm(V2 ~ V1, data = corr_data)
my_residuals <- abs(residuals(corr_model))
data_with_resid <- round(cbind(corr_data, my_residuals), 2)
slopes <- data_with_resid %>%
mutate(decay_linear = ((-my_residuals/2.6) + 1)) %>%
mutate(decay_inverted = 1-(0.25)^my_residuals) %>%
mutate(decay_non_linear = (1 + (0.25)^ my_residuals)-1) %>%
pivot_longer(cols = starts_with("de"),
names_to = c("decay"),
values_to = "transformed_residual")
slopes %>%
mutate(decay = str_replace_all(decay, pattern = "_", replacement = " ")) %>%
mutate(decay = str_to_title(decay)) %>%
ggplot(aes(x = my_residuals, y = transformed_residual)) +
geom_line(aes(colour = decay)) +
scale_x_continuous(breaks = scales::pretty_breaks(n = 20), limits = c(0,2.6)) +
labs(x = "Residual",
y = "Contrast Alpha",
title = "Relationship between residual and contrast alpha value") +
theme_minimal() +
theme(legend.title = element_blank(),
legend.position = "none") +
annotate(geom = "text", x  = 1.3, y = 0.12, label = "Non-Linear Decay", angle = -20) +
annotate(geom = "text", x  = 1.3, y = 0.44, label = "Linear Decay", angle = -30) +
annotate(geom = "text", x  = 2, y = 0.88, label = "Non-Linear Inverted Decay", angle = 8)
coord_cartesian(xlim = c(0,2.6), ylim = c(0,1))
library(MASS)
set.seed(1234)
my_desired_r = 0.2
my_sample_size = 128
mean_variable_1 = 0
sd_variable_1 = 1
mean_variable_2 = 0
sd_variable_2 = 1
mu <- c(mean_variable_1, mean_variable_2)
myr <- my_desired_r * sqrt(sd_variable_1) * sqrt(sd_variable_2)
mysigma <- matrix(c(sd_variable_1, myr, myr, sd_variable_2), 2, 2)
corr_data = as_tibble(mvrnorm(my_sample_size, mu, mysigma, empirical = TRUE))
corr_model <- lm(V2 ~ V1, data = corr_data)
my_residuals <- abs(residuals(corr_model))
data_with_resid <- round(cbind(corr_data, my_residuals), 2)
slopes <- data_with_resid %>%
mutate(decay_linear = ((-my_residuals/2.6) + 1)) %>%
mutate(decay_inverted = 1-(0.25)^my_residuals) %>%
mutate(decay_non_linear = (1 + (0.25)^ my_residuals)-1) %>%
pivot_longer(cols = starts_with("de"),
names_to = c("decay"),
values_to = "transformed_residual")
slopes %>%
mutate(decay = str_replace_all(decay, pattern = "_", replacement = " ")) %>%
mutate(decay = str_to_title(decay)) %>%
ggplot(aes(x = my_residuals, y = transformed_residual)) +
geom_line(aes(colour = decay)) +
scale_x_continuous(breaks = scales::pretty_breaks(n = 20), limits = c(0,2.6)) +
labs(x = "Residual",
y = "Contrast Alpha",
title = "Relationship between residual and contrast alpha value") +
theme_minimal() +
theme(legend.title = element_blank(),
legend.position = "none") +
annotate(geom = "text", x  = 1.3, y = 0.12, label = "Non-Linear Decay", angle = -20) +
annotate(geom = "text", x  = 1.3, y = 0.44, label = "Linear Decay", angle = -30) +
annotate(geom = "text", x  = 2, y = 0.88, label = "Non-Linear Inverted Decay", angle = 8)
coord_cartesian(xlim = c(0,2.6), ylim = c(0,1))
